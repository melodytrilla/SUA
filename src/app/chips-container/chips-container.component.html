<div class="container">

    
    <h5 class="legend">Subtipo: </h5>

    <mat-chip-list #chipList>
        <mat-chip *ngFor="let chip of chips" 
            [selectable]="selectable" 
            [removable]="removable" 
            (removed)="remove(chip)"
            color="primary" selected="true">
                <mat-icon class="fsua {{chip.estilo}} fsua-2x"></mat-icon>
                <div class="chip">
                    <h6 class="subtitulo">{{chip.categoria}}</h6>
                    {{chip.descripcion}}
                </div>
            <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
    <div>
        <button *ngIf="!searchBoxVisible" mat-chip class="add" (click)="showSearch()">Agregar + (min 4 letras)</button>

        <div *ngIf="searchBoxVisible">
            <input matInput  #search
                #trigger = "matAutocompleteTrigger"
                id="search"
                placeholder = "Agregar (min 4 letras)"
                autocapitalize="off"
                autocomplete="off"
                (input)="onSearchChange($event.target.value)"
                [matChipInputFor] = "chipList"
                [matChipInputSeparatorKeyCodes] = "separatorKeys"
                [matChipInputAddOnBlur] = "addOnBlur"
                [matAutocomplete]="auto"/>

            <!--(optionSelected)="selected($event)" recordatorio volver a ponner en autocomplete si no funciona-->
            <mat-autocomplete #auto="matAutocomplete" >
                <ng-container *ngFor="let categoria of filteredCategories">
                    <mat-option  class="labelOpcion" [value]="categoria" (click)="getAllCategoria(categoria); trigger.closePanel()">
                        {{categoria}}
                    </mat-option>

                    <ng-container *ngFor="let option of filteredOptions">
                        <mat-option class="subOpcion" [value]="option" *ngIf= "option.categoria == categoria" (click) = "selected(option)">
                            {{ option.descripcion }}
                        </mat-option>
                    </ng-container>

                </ng-container>
                <!--
                <mat-optgroup *ngFor="let categoria of filteredCategories" [label]="categoria" (click)="getAllCategoria(categoria); trigger.closePanel()">
                    <ng-container *ngFor="let option of filteredOptions">
                        <mat-option *ngIf= "option.categoria == categoria" [value]="option">
                            {{ option.descripcion }}
                        </mat-option>
                    </ng-container>
                </mat-optgroup>
            -->
            </mat-autocomplete>
        </div>
    </div>
        
    </mat-chip-list>
</div>
